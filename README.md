# å·¥ä½œæµè®¾è®¡å™¨ (Workflow Designer)

ä¸€ä¸ªåŸºäº Vue.js 3 + TypeScript + Vite çš„å¯è§†åŒ–å·¥ä½œæµç¼–æ’ç³»ç»Ÿã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸ“‹ é¦–é¡µåŠŸèƒ½
- **æ–°å»ºå·¥ä½œæµ** - åˆ›å»ºç©ºç™½å·¥ä½œæµè®¾è®¡
- **å¯¼å…¥å·¥ä½œæµ** - ä» XML æ–‡ä»¶å¯¼å…¥å·²æœ‰è®¾è®¡
- å“åº”å¼å¡ç‰‡å¸ƒå±€ï¼Œæ”¯æŒç§»åŠ¨ç«¯é€‚é…

### ğŸ¨ è®¾è®¡å™¨æ ¸å¿ƒåŠŸèƒ½

#### èŠ‚ç‚¹æ“ä½œ
- **æ‹–æ‹½æ·»åŠ èŠ‚ç‚¹** - ä»å·¦ä¾§ç»„ä»¶åº“æ‹–æ‹½èŠ‚ç‚¹åˆ°ç”»å¸ƒ
- **èŠ‚ç‚¹ç±»å‹**ï¼š
  - å­æµç¨‹èŠ‚ç‚¹ (ç»¿è‰²) âš™ï¸
  - æ¥å£è°ƒç”¨èŠ‚ç‚¹ (æ©™è‰²) ğŸ”—
  - æ¥å£å¾ªç¯è°ƒç”¨èŠ‚ç‚¹ (è“è‰²) ğŸ”„
- **æ¡ä»¶ç½‘å…³èŠ‚ç‚¹** (ç´«è‰²) â—‡ - ç”¨äºæ¡ä»¶åˆ†æ”¯
- **èŠ‚ç‚¹å±æ€§ç¼–è¾‘** - ç‚¹å‡»èŠ‚ç‚¹å¯åœ¨å³ä¾§é¢æ¿ç¼–è¾‘åç§°
- **è‡ªå®šä¹‰èŠ‚ç‚¹æ ·å¼** - ç»Ÿä¸€çš„èŠ‚ç‚¹å¤–è§‚è®¾è®¡

#### èŠ‚ç‚¹åç§°è§„åˆ™
- **å¿…å¡«åç§°** - åˆ›å»ºèŠ‚ç‚¹æ—¶å¿…é¡»è¾“å…¥åç§°ï¼Œä¸è¾“å…¥åˆ™èŠ‚ç‚¹ä¼šè¢«åˆ é™¤
- **åç§°æ ¡éªŒ** - åç§°ä¸º1-32ä¸ªéç©ºç™½å­—ç¬¦
- **å®æ—¶åŒæ­¥** - åœ¨å³ä¾§å±æ€§æ ä¿®æ”¹åç§°æ—¶ï¼Œç”»å¸ƒä¸Šçš„èŠ‚ç‚¹å®æ—¶æ›´æ–°
- **èŠ‚ç‚¹ç±»å‹** - ç±»å‹ç”±åˆ›å»ºæ—¶å†³å®šï¼Œä¸å¯ä¿®æ”¹
- **é»˜è®¤å°ºå¯¸** - èŠ‚ç‚¹æœ€å°å°ºå¯¸ 120x50ï¼Œé¿å…è¾“å…¥åç§°åå˜å½¢

#### é¦–æ¬¡åˆ›å»ºæµç¨‹
1. ä»å·¦ä¾§æ‹–æ‹½èŠ‚ç‚¹åˆ°ç”»å¸ƒ
2. è‡ªåŠ¨å±•å¼€å³ä¾§å±æ€§ç¼–è¾‘æ 
3. åç§°è¾“å…¥æ¡†è‡ªåŠ¨èšç„¦
4. ç”»å¸ƒæ˜¾ç¤ºé®ç½©ï¼Œå¼•å¯¼æ‚¨è¾“å…¥åç§°
5. è¾“å…¥æœ‰æ•ˆåç§°ï¼ˆ1-32ä¸ªéç©ºç™½å­—ç¬¦ï¼‰åé®ç½©æ¶ˆå¤±
6. å¦‚ä¸è¾“å…¥åç§°å°±ç¦»å¼€ï¼ŒèŠ‚ç‚¹è‡ªåŠ¨åˆ é™¤

#### è¿çº¿åŠŸèƒ½
- **ç›´çº¿è¿æ¥** - èŠ‚ç‚¹é—´ä½¿ç”¨ç›´çº¿è¿æ¥
- **é»‘è‰²ç®­å¤´** - è¿çº¿ç»ˆç‚¹å¸¦æœ‰æ–¹å‘ç®­å¤´
- **æ™ºèƒ½è¿æ¥ç‚¹æ˜¾ç¤º**ï¼š
  - é»˜è®¤éšè—æ‰€æœ‰è¿æ¥ç‚¹
  - é¼ æ ‡æ‚¬æµ®åˆ°å…·ä½“è¿æ¥ç‚¹æ—¶æ‰æ˜¾ç¤º
  - è¿çº¿æˆåŠŸåè¯¥è¿æ¥ç‚¹æ°¸ä¹…æ˜¾ç¤º
  - åˆ é™¤æ‰€æœ‰è¿çº¿åè‡ªåŠ¨éšè—
- **åˆ é™¤è¿çº¿** - åŒå‡»è¿çº¿å³å¯åˆ é™¤
- **è¿çº¿è§„åˆ™**ï¼š
  - åŒä¸€è¿æ¥ç‚¹æœ€å¤šåªèƒ½æœ‰ä¸€æ¡è¿çº¿ï¼ˆæ— è®ºæ˜¯ä½œä¸ºèµ·ç‚¹è¿˜æ˜¯ç»ˆç‚¹ï¼‰
  - ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´åªèƒ½æœ‰ä¸€æ¡è¿çº¿ï¼ˆä¸æ”¯æŒåŒå‘è¿æ¥ï¼‰

#### æ¡ä»¶é…ç½®
- **Status æ¡ä»¶** - æ ¹æ® HTTP çŠ¶æ€ç åŒ¹é…
- **å‚æ•°æ¡ä»¶** - æ ¹æ®è¿”å›å‚æ•°å€¼åŒ¹é…
- **æ“ä½œç¬¦æ”¯æŒ**ï¼š
  - `=` ç­‰äº
  - `â‰ ` ä¸ç­‰äº
  - `âŠ†` åŒ…å«
  - `~` æ­£åˆ™åŒ¹é…
- **ä¼˜å…ˆçº§** - æ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜ (0-10)

#### æ¡ä»¶ç½‘å…³ (Conditional Gateway) â­ æ–°åŠŸèƒ½
- **è½¬æ¢ä¸ºæ¡ä»¶ç½‘å…³** - å³é”®ç‚¹å‡»è¿çº¿ â†’ "è½¬æ¢ä¸ºæ¡ä»¶ç½‘å…³"
- **è¿·ä½ ç½‘å…³è®¾è®¡** - 20x20px ç´«è‰²åœ†å½¢èŠ‚ç‚¹ï¼Œæœ€å°åŒ–è§†è§‰å¹²æ‰°
- **è¿æ¥ç‚¹å¸ƒå±€**ï¼š
  - å·¦ä¾§ï¼šå…¥è¾¹è¿æ¥ç‚¹ï¼ˆæ¥æ”¶æºèŠ‚ç‚¹è¿çº¿ï¼‰
  - å³ä¾§ï¼šå‡ºè¾¹è¿æ¥ç‚¹ï¼ˆè¿æ¥ç›®æ ‡èŠ‚ç‚¹ï¼‰
  - ä¸Šä¸‹ä¸¤ä¾§ï¼š5ä¸ªåˆ†æ”¯è¿æ¥ç‚¹ï¼ˆäº¤æ›¿åˆ†å¸ƒï¼‰
- **è¿çº¿ä¿ç•™**ï¼šåˆ›å»ºç½‘å…³æ—¶ä¿ç•™åŸè¿çº¿ä½œä¸ºé»˜è®¤æ¡ä»¶è¾¹
- **æ¡ä»¶ç»§æ‰¿**ï¼šåŸè¿çº¿æ¡ä»¶è‡ªåŠ¨ç»§æ‰¿åˆ°é»˜è®¤åˆ†æ”¯
- **åˆ†æ”¯ç®¡ç†**ï¼š
  - æ¯ä¸ªç½‘å…³æœ€å¤š 5 ä¸ªåˆ†æ”¯
  - ç‚¹å‡»åˆ†æ”¯å¯ç¼–è¾‘åˆ†æ”¯æ¡ä»¶
  - æ”¯æŒåˆ é™¤åˆ†æ”¯ï¼ˆæœ€å°‘ä¿ç•™1ä¸ªï¼‰
  - æ”¯æŒæ·»åŠ æ–°åˆ†æ”¯
- **åµŒå¥—æ”¯æŒ** - æœ€å¤šæ”¯æŒ 3 å±‚åµŒå¥—
- **æ¡ä»¶ç»§æ‰¿** - åˆ†æ”¯å¯ç»§æ‰¿ç½‘å…³ä¸»æ¡ä»¶
- **å¯è§†åŒ–** - ç´«è‰²ç½‘å…³èŠ‚ç‚¹ï¼Œæ¸…æ™°å±•ç¤ºåˆ†æ”¯ç»“æ„

#### æ¡ä»¶ç½‘å…³ä½¿ç”¨æµç¨‹
1. åˆ›å»ºä¸¤ä¸ªèŠ‚ç‚¹å¹¶è¿æ¥
2. å³é”®ç‚¹å‡»è¿çº¿ï¼Œé€‰æ‹©"è½¬æ¢ä¸ºæ¡ä»¶ç½‘å…³"
3. ç³»ç»Ÿè‡ªåŠ¨ï¼š
   - åœ¨è¿çº¿ä¸­ç‚¹åˆ›å»º 20px ç´«è‰²åœ†å½¢ç½‘å…³èŠ‚ç‚¹
   - ä¿ç•™åŸè¿çº¿ä½œä¸ºå‡ºè¾¹ï¼ˆç»§æ‰¿æ‰€æœ‰æ¡ä»¶ï¼‰
   - åˆ›å»ºå…¥è¾¹è¿æ¥æºèŠ‚ç‚¹åˆ°ç½‘å…³
4. åœ¨å³ä¾§é¢æ¿ç¼–è¾‘æ¡ä»¶
5. ä»ç½‘å…³ä¸Šä¸‹åˆ†æ”¯ç‚¹æ‹–æ‹½åˆ›å»ºæ–°åˆ†æ”¯

#### ç”»å¸ƒæ“ä½œ
- **ç¼©æ”¾æ§åˆ¶** - æ”¯æŒæ‹–æ‹½ç¼©æ”¾å’Œå¹³ç§»
- **ç½‘æ ¼èƒŒæ™¯** - ä¾¿äºèŠ‚ç‚¹å®šä½å¯¹é½
- **å°åœ°å›¾** - å¿«é€Ÿå¯¼èˆªå¤§å‹å·¥ä½œæµ
- **æ§åˆ¶é¢æ¿** - ç¼©æ”¾ã€é‡ç½®è§†è§’ç­‰æ“ä½œ
- **é®ç½©çŠ¶æ€ç®¡ç†**ï¼š
  - ç¼–è¾‘çŠ¶æ€ä¸‹æ˜¾ç¤ºé®ç½©ï¼Œé˜»æ­¢å…¶ä»–æ“ä½œ
  - é®ç½©çŠ¶æ€ä¸‹ç¦ç”¨æ‰€æœ‰ç”»å¸ƒæ“ä½œï¼ˆæ‹–æ‹½ã€è¿çº¿ã€ç‚¹å‡»ç­‰ï¼‰
  - ç‚¹å‡»ç”»å¸ƒç©ºç™½å¤„å¯å–æ¶ˆç¼–è¾‘çŠ¶æ€

### ğŸ’¾ æ•°æ®æŒä¹…åŒ–

#### XML å¯¼å‡º
- å¯¼å‡ºå®Œæ•´å·¥ä½œæµå®šä¹‰
- åŒ…å«èŠ‚ç‚¹ã€ä½ç½®ã€è¿çº¿ä¿¡æ¯
- æ”¯æŒå¯¼å…¥æ¢å¤è®¾è®¡

#### XML å¯¼å…¥
- è§£ææ ‡å‡†æ ¼å¼çš„ XML æ–‡ä»¶
- æ¢å¤èŠ‚ç‚¹ä½ç½®å’Œè¿çº¿å…³ç³»
- æ”¯æŒå¢é‡å¼€å‘å·¥ä½œæµ

## æŠ€æœ¯æ ˆ

- **å‰ç«¯æ¡†æ¶**: Vue.js 3 (Composition API)
- **æ„å»ºå·¥å…·**: Vite 5
- **è¯­è¨€**: TypeScript
- **çŠ¶æ€ç®¡ç†**: Pinia
- **è·¯ç”±**: Vue Router
- **å›¾å½¢åº“**: Vue Flow
- **æ ·å¼**: Tailwind CSS 3
- **åŒ…ç®¡ç†**: npm

## å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

```bash
npm install
```

### å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

è®¿é—® http://localhost:5173

### æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
npm run build
```

## é¡¹ç›®ç»“æ„

```
workflow-designer/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ assets/
â”‚   â”‚   â”œâ”€â”€ main.css          # å…¨å±€æ ·å¼
â”‚   â”‚   â””â”€â”€ vueflow.css      # Vue Flow è‡ªå®šä¹‰æ ·å¼
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ CustomNode.vue    # è‡ªå®šä¹‰èŠ‚ç‚¹ç»„ä»¶
â”‚   â”‚   â””â”€â”€ ConditionGatewayNode.vue  # æ¡ä»¶ç½‘å…³èŠ‚ç‚¹ç»„ä»¶ â­ æ–°å¢
â”‚   â”œâ”€â”€ router/
â”‚   â”‚   â””â”€â”€ index.ts          # è·¯ç”±é…ç½®
â”‚   â”œâ”€â”€ stores/
â”‚   â”‚   â””â”€â”€ workflow.ts       # å·¥ä½œæµçŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â””â”€â”€ xmlParser.ts     # XML è§£æå·¥å…· (æ”¯æŒåµŒå¥—æ¡ä»¶) â­ å·²æ›´æ–°
â”‚   â”œâ”€â”€ views/
â”‚   â”‚   â”œâ”€â”€ HomeView.vue     # é¦–é¡µ
â”‚   â”‚   â””â”€â”€ DesignerView.vue  # è®¾è®¡å™¨é¡µé¢ (æ”¯æŒæ¡ä»¶ç½‘å…³) â­ å·²æ›´æ–°
â”‚   â”œâ”€â”€ App.vue
â”‚   â””â”€â”€ main.ts
â”œâ”€â”€ index.html
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ vite.config.ts
â””â”€â”€ README.md
```

## ä½¿ç”¨è¯´æ˜

### åˆ›å»ºå·¥ä½œæµ

1. ç‚¹å‡»é¦–é¡µçš„"æ–°å»ºå·¥ä½œæµ"å¡ç‰‡
2. è¿›å…¥ç©ºç™½è®¾è®¡ç”»å¸ƒ
3. ä»å·¦ä¾§ç»„ä»¶åº“æ‹–æ‹½èŠ‚ç‚¹åˆ°ç”»å¸ƒ
4. åœ¨å³ä¾§å±æ€§æ è¾“å…¥èŠ‚ç‚¹åç§°ï¼ˆå¿…å¡«ï¼Œ1-32ä¸ªéç©ºç™½å­—ç¬¦ï¼‰
5. æ‹–æ‹½è¿æ¥ç‚¹åˆ›å»ºè¿çº¿
6. ç‚¹å‡»èŠ‚ç‚¹å¯ç¼–è¾‘å±æ€§

### èŠ‚ç‚¹åç§°è§„åˆ™

- é¦–æ¬¡æ‹–æ‹½èŠ‚ç‚¹åˆ°ç”»å¸ƒæ—¶ï¼Œå¿…é¡»è¾“å…¥èŠ‚ç‚¹åç§°
- åç§°ä¸èƒ½ä¸ºç©ºæˆ–å…¨ç©ºç™½å­—ç¬¦
- åç§°é•¿åº¦é™åˆ¶ä¸º1-32ä¸ªå­—ç¬¦
- å¦‚æœä¸è¾“å…¥åç§°å°±ç¦»å¼€è¾“å…¥æ¡†ï¼ŒèŠ‚ç‚¹ä¼šè¢«è‡ªåŠ¨åˆ é™¤

### å¯¼å…¥å·¥ä½œæµ

1. ç‚¹å‡»é¦–é¡µçš„"å¯¼å…¥å·¥ä½œæµ"å¡ç‰‡
2. é€‰æ‹© XML æ–‡ä»¶
3. è‡ªåŠ¨åŠ è½½å·¥ä½œæµè®¾è®¡

### å¯¼å‡ºå·¥ä½œæµ

1. åœ¨è®¾è®¡å™¨é¡µé¢ç‚¹å‡»"å¯¼å‡º XML"æŒ‰é’®
2. ä¿å­˜ XML æ–‡ä»¶åˆ°æœ¬åœ°
3. å¯ç”¨äºå¤‡ä»½æˆ–åˆ†äº«

### ä½¿ç”¨æ¡ä»¶ç½‘å…³ â­ æ–°åŠŸèƒ½

#### åˆ›å»ºæ¡ä»¶ç½‘å…³

1. åˆ›å»ºä¸¤ä¸ªèŠ‚ç‚¹ï¼ˆå¦‚ï¼šå¼€å§‹èŠ‚ç‚¹ â†’ å¤„ç†èŠ‚ç‚¹ï¼‰
2. å°†å®ƒä»¬è¿æ¥èµ·æ¥
3. å³é”®ç‚¹å‡»è¿çº¿
4. é€‰æ‹©"è½¬æ¢ä¸ºæ¡ä»¶ç½‘å…³"
5. ç³»ç»Ÿä¼šåœ¨è¿çº¿ä¸­ç‚¹åˆ›å»ºä¸€ä¸ªç´«è‰²ç½‘å…³èŠ‚ç‚¹

#### ç¼–è¾‘ç½‘å…³æ¡ä»¶

1. ç‚¹å‡»æ¡ä»¶ç½‘å…³èŠ‚ç‚¹
2. åœ¨å³ä¾§é¢æ¿å¯ç¼–è¾‘ï¼š
   - **ä¸»æ¡ä»¶** - å½±å“æ‰€æœ‰åˆ†æ”¯çš„é»˜è®¤æ¡ä»¶
   - **åˆ†æ”¯åˆ—è¡¨** - ç®¡ç†æ‰€æœ‰åˆ†æ”¯ (æœ€å¤š5ä¸ª)
   - **æ·»åŠ åˆ†æ”¯** - ç‚¹å‡»æŒ‰é’®æ·»åŠ æ–°åˆ†æ”¯
   - **åˆ é™¤åˆ†æ”¯** - ç‚¹å‡»åˆ†æ”¯æ—çš„åˆ é™¤æŒ‰é’®ï¼ˆè‡³å°‘ä¿ç•™1ä¸ªï¼‰

#### é…ç½®åˆ†æ”¯æ¡ä»¶

1. åœ¨åˆ†æ”¯åˆ—è¡¨ä¸­ç‚¹å‡»è¦ç¼–è¾‘çš„åˆ†æ”¯
2. è®¾ç½®è¯¥åˆ†æ”¯ç‰¹æœ‰çš„æ¡ä»¶ï¼š
   - Status æ¡ä»¶ï¼ˆå¯é€‰ï¼‰
   - å‚æ•°æ¡ä»¶ï¼ˆå¯é€‰ï¼‰
3. æœªè®¾ç½®çš„å­—æ®µä¼šç»§æ‰¿ç½‘å…³ä¸»æ¡ä»¶

#### åµŒå¥—æ¡ä»¶ç½‘å…³

- æ”¯æŒæœ€å¤š **3 å±‚** åµŒå¥—
- åœ¨åˆ†æ”¯çš„è¿çº¿ä¸Šå†æ¬¡æ‰§è¡Œ"è½¬æ¢ä¸ºæ¡ä»¶ç½‘å…³"
- å¯åˆ›å»ºå¤æ‚çš„æ¡ä»¶åˆ¤æ–­é€»è¾‘

### æ¡ä»¶è§„åˆ™è¯´æ˜

- **æ¡ä»¶ç»„åˆ**ï¼šStatus æ¡ä»¶å’Œå‚æ•°æ¡ä»¶é»˜è®¤ä½¿ç”¨"ä¸”"é€»è¾‘
- **ä¼˜å…ˆçº§**ï¼š
  - ä¼˜å…ˆçº§æ•°å­—è¶Šå°ï¼ŒåŒ¹é…ä¼˜å…ˆçº§è¶Šé«˜ (0-10)
  - é»˜è®¤ä¼˜å…ˆçº§ä¸º 10
- **å‚æ•°éªŒè¯**ï¼š
  - å¦‚æœå‚æ•°å€¼ä¸ºç©ºï¼Œå‚æ•°åå¯ä»¥ä¸ºç©º
  - å¦‚æœå‚æ•°å€¼ä¸ä¸ºç©ºï¼Œå‚æ•°åå¿…é¡»å¡«å†™

## ç•Œé¢é¢„è§ˆ

### é¦–é¡µ
- æ¸å˜ç´«è‰²èƒŒæ™¯
- ä¸¤ä¸ªåŠŸèƒ½å¡ç‰‡å¹¶æ’æ˜¾ç¤º
- ç°ä»£åŒ–ç®€æ´è®¾è®¡

### è®¾è®¡å™¨
- ä¸‰æ å¸ƒå±€ï¼šç»„ä»¶åº“ | ç”»å¸ƒ | å±æ€§ç¼–è¾‘ï¼ˆé»˜è®¤éšè—ï¼‰
- æ‹–æ‹½èŠ‚ç‚¹åè‡ªåŠ¨å±•å¼€å³ä¾§å±æ€§æ 
- é¦–æ¬¡åˆ›å»ºæ—¶ç”»å¸ƒæ˜¾ç¤ºé®ç½©ï¼Œå¼•å¯¼è¾“å…¥åç§°
- æ‚¬æµ®æ˜¾ç¤ºè¿æ¥ç‚¹
- é»‘è‰²ç®­å¤´è¿çº¿
- æµç•…çš„åŠ¨ç”»æ•ˆæœ

### èŠ‚ç‚¹åç§°è¾“å…¥
- åˆ›å»ºèŠ‚ç‚¹åè‡ªåŠ¨èšç„¦åˆ°åç§°è¾“å…¥æ¡†
- åç§°æ ¡éªŒæç¤ºï¼šåç§°ä¸º1-32ä¸ªéç©ºç™½å­—ç¬¦
- ä¸è¾“å…¥æœ‰æ•ˆåç§°æ— æ³•è¿›è¡Œå…¶ä»–æ“ä½œ

### æ¡ä»¶ç½‘å…³ç•Œé¢ â­ æ–°åŠŸèƒ½
- **è¿·ä½ ç½‘å…³èŠ‚ç‚¹** - 20x20px ç´«è‰²åœ†å½¢è®¾è®¡ï¼Œæœ€å°åŒ–è§†è§‰å¹²æ‰°
- **è¿æ¥ç‚¹å¸ƒå±€** - å·¦ä¾§å…¥è¾¹ã€å³ä¾§å‡ºè¾¹ã€ä¸Šä¸‹åˆ†æ”¯è¿æ¥ç‚¹
- **è¿çº¿ç»“æ„** - æºèŠ‚ç‚¹ â†’ ç½‘å…³ï¼ˆå…¥è¾¹ï¼‰â†’ ç›®æ ‡èŠ‚ç‚¹ï¼ˆå‡ºè¾¹ï¼Œä¿ç•™åŸæ¡ä»¶ï¼‰
- **åˆ†æ”¯åˆ—è¡¨é¢æ¿** - å³ä¾§æ˜¾ç¤ºåˆ†æ”¯ç®¡ç†ç•Œé¢
- **æ·»åŠ /åˆ é™¤æŒ‰é’®** - ç›´è§‚æ“ä½œåˆ†æ”¯
- **æ¡ä»¶ç»§æ‰¿æ˜¾ç¤º** - å¯åŒºåˆ†ä¸»æ¡ä»¶å’Œåˆ†æ”¯æ¡ä»¶
- **å³é”®èœå•** - ä¾¿æ·çš„ä¸Šä¸‹æ–‡æ“ä½œ

## æµè§ˆå™¨å…¼å®¹æ€§

- Chrome (æ¨è)
- Edge
- Firefox
- Safari

## æ›´æ–°æ—¥å¿—

### v2.1 - æ¡ä»¶ç½‘å…³åŠŸèƒ½ä¼˜åŒ– (2026-02-10)

#### åŠŸèƒ½æ”¹è¿›

**1. æ¡ä»¶ç½‘å…³ç•Œé¢ä¼˜åŒ–**
- **å°ºå¯¸ä¼˜åŒ–**ï¼šç½‘å…³èŠ‚ç‚¹ä» 140x60px ç¼©å°è‡³ 20x20pxï¼ˆåœ†å½¢ï¼‰ï¼Œæœ€å°åŒ–è§†è§‰å¹²æ‰°
- **è¿æ¥ç‚¹å¸ƒå±€**ï¼šæ”¹ä¸ºå·¦å…¥å³å‡º + ä¸Šä¸‹åˆ†æ”¯å¸ƒå±€
  - å·¦ä¾§ï¼šå…¥è¾¹è¿æ¥ç‚¹ï¼ˆæ¥æ”¶æºèŠ‚ç‚¹è¿çº¿ï¼‰
  - å³ä¾§ï¼šå‡ºè¾¹è¿æ¥ç‚¹ï¼ˆè¿æ¥ç›®æ ‡èŠ‚ç‚¹ï¼‰
  - ä¸Šä¸‹ä¸¤ä¾§ï¼š5ä¸ªåˆ†æ”¯è¿æ¥ç‚¹ï¼ˆäº¤æ›¿åˆ†å¸ƒï¼‰

**2. è¿çº¿æ¡ä»¶åµŒå¥—æ–¹æ¡ˆä¼˜åŒ–**
- **ä¿ç•™åŸè¿çº¿**ï¼šåˆ›å»ºæ¡ä»¶ç½‘å…³æ—¶ï¼ŒåŸè¿çº¿ä¿ç•™ä½œä¸ºé»˜è®¤æ¡ä»¶è¾¹
- **æ¡ä»¶ç»§æ‰¿**ï¼šåŸè¿çº¿çš„æ‰€æœ‰æ¡ä»¶è‡ªåŠ¨ç»§æ‰¿åˆ°é»˜è®¤åˆ†æ”¯
- **ä¸­é—´é”šç‚¹**ï¼šç½‘å…³ä½œä¸ºæºèŠ‚ç‚¹å’Œç›®æ ‡èŠ‚ç‚¹çš„ä¸­é—´é”šç‚¹ï¼Œå½¢æˆï¼šæºèŠ‚ç‚¹ â†’ ç½‘å…³ â†’ ç›®æ ‡èŠ‚ç‚¹

**3. é®ç½©çŠ¶æ€ç®¡ç†å¢å¼º**
- **æ“ä½œé™åˆ¶**ï¼šé®ç½©çŠ¶æ€ä¸‹ç¦ç”¨æ‰€æœ‰ç”»å¸ƒæ“ä½œ
  - ç¦æ­¢æ‹–æ‹½æ·»åŠ èŠ‚ç‚¹
  - ç¦æ­¢ç‚¹å‡»èŠ‚ç‚¹/è¿çº¿
  - ç¦æ­¢åˆ›å»ºæ–°è¿çº¿
  - ç¦æ­¢å³é”®èœå•æ“ä½œ
  - ç¦æ­¢åŒå‡»åˆ é™¤è¿çº¿
- **æ™ºèƒ½å–æ¶ˆ**ï¼šåˆ›å»ºèŠ‚ç‚¹åæœªè¾“å…¥æˆ–è¾“å…¥ä¸åˆæ³•æ—¶ç‚¹å‡»ç”»å¸ƒï¼Œè‡ªåŠ¨åˆ é™¤è¯¥èŠ‚ç‚¹å¹¶å–æ¶ˆé®ç½©

**4. ç¼–è¾‘çŠ¶æ€ç®¡ç†ç»Ÿä¸€**
- æ–°å¢ `clearAllEditingStates` ç»Ÿä¸€å‡½æ•°ï¼Œç®¡ç†æ‰€æœ‰ç¼–è¾‘çŠ¶æ€å’Œé®ç½©
- ä¿®å¤ç¼–è¾‘æ æ˜¾ç¤º/éšè—é€»è¾‘
- ä¼˜åŒ–èŠ‚ç‚¹åˆ›å»ºæµç¨‹çš„çŠ¶æ€ç®¡ç†

#### æŠ€æœ¯å®ç°

**å…³é”®æ–‡ä»¶ä¿®æ”¹**ï¼š
- `ConditionGatewayNode.vue` - èŠ‚ç‚¹å°ºå¯¸ç¼©å°ï¼Œè¿æ¥ç‚¹å¸ƒå±€è°ƒæ•´
- `DesignerView.vue` - æ¡ä»¶ç½‘å…³åˆ›å»ºé€»è¾‘é‡æ„ï¼Œé®ç½©çŠ¶æ€ç®¡ç†ä¼˜åŒ–
- ç±»å‹å®šä¹‰æ›´æ–°ï¼Œç¡®ä¿ç±»å‹å®‰å…¨

#### ä½¿ç”¨æµç¨‹æ›´æ–°

1. åˆ›å»ºä¸¤ä¸ªèŠ‚ç‚¹å¹¶è¿æ¥
2. å³é”®ç‚¹å‡»è¿çº¿ï¼Œé€‰æ‹©"è½¬æ¢ä¸ºæ¡ä»¶ç½‘å…³"
3. ç³»ç»Ÿè‡ªåŠ¨ï¼š
   - åœ¨è¿çº¿ä¸­ç‚¹åˆ›å»º 20px ç´«è‰²åœ†å½¢ç½‘å…³èŠ‚ç‚¹
   - ä¿ç•™åŸè¿çº¿ä½œä¸ºå‡ºè¾¹ï¼ˆç»§æ‰¿æ‰€æœ‰æ¡ä»¶ï¼‰
   - åˆ›å»ºå…¥è¾¹è¿æ¥æºèŠ‚ç‚¹åˆ°ç½‘å…³
4. åœ¨å³ä¾§é¢æ¿ç¼–è¾‘æ¡ä»¶
5. ä»ç½‘å…³ä¸Šä¸‹åˆ†æ”¯ç‚¹æ‹–æ‹½åˆ›å»ºæ–°åˆ†æ”¯

---

## è®¸å¯è¯

MIT License

---

## ä»£ç è®¾è®¡å®ç°

### æŠ€æœ¯æ¶æ„

```plantuml
@startuml
skinparam backgroundColor white
skinparam rectangleBackgroundColor white

rectangle "Vue Router" as Router {
  rectangle "home" as Home
  rectangle "designer" as Designer
}

rectangle "Pinia Store" as Store #LightBlue {
  storage "importedWorkflow" as Data1
  storage "hasImportedData" as Data2
}

rectangle "Views" as Views {
  rectangle "HomeView" as HV
  rectangle "DesignerView" as DV
}

rectangle "Components" as Comp {
  rectangle "CustomNode" as CN
}

rectangle "Vue Flow" as VF {
  rectangle "Background" as BG
  rectangle "Controls" as CT
  rectangle "MiniMap" as MM
}

Home -[hidden]right- Designer
HV ..> Store : setImportedWorkflow
DV ..> Store : hasImportedData
DV ..> Store : importedWorkflow
DV --> CN : æ¸²æŸ“èŠ‚ç‚¹
DV --> BG : ç½‘æ ¼èƒŒæ™¯
DV --> CT : æ§åˆ¶é¢æ¿
DV --> MM : å°åœ°å›¾
@enduml
```

### æ•°æ®æµè®¾è®¡

```plantuml
@startuml
skinparam backgroundColor white

actor User
rectangle "HomeView" as HV
rectangle "Pinia Store" as Store
rectangle "DesignerView" as DV
database "XML File" as XML

User --> HV : 1. é€‰æ‹©XMLæ–‡ä»¶
HV --> XML : 2. è¯»å–æ–‡ä»¶å†…å®¹
XML --> HV : æ–‡ä»¶å†…å®¹
HV --> Store : 3. setImportedWorkflow(data)
Store --> DV : 4. hasImportedData = true
DV --> Store : 5. è¯»å–importedWorkflow
DV --> DV : 6. loadImportedWorkflow()
DV --> DV : 7. æ¸²æŸ“èŠ‚ç‚¹å’Œè¿çº¿
@enduml
```

### XML æ•°æ®æ ¼å¼

#### å¯¼å‡º XML ç»“æ„

```xml
<?xml version="1.0" encoding="UTF-8"?>
<workflow name="å·¥ä½œæµåç§°">
  <nodes>
    <node id="èŠ‚ç‚¹ID" type="èŠ‚ç‚¹ç±»å‹" label="èŠ‚ç‚¹æ ‡ç­¾">
      <position x="æ¨ªåæ ‡" y="çºµåæ ‡"/>
    </node>
    ...
  </nodes>
  <edges>
    <edge id="e0" source="æºèŠ‚ç‚¹ID" target="ç›®æ ‡èŠ‚ç‚¹ID"/>
    ...
  </edges>
</workflow>
```

#### èŠ‚ç‚¹ç±»å‹æ˜ å°„

| ç±»å‹ | ç±»å‹å€¼ | é¢œè‰² | å›¾æ ‡ |
|------|--------|------|------|
| å­æµç¨‹ | `subprocess` | `#10b981` (ç»¿è‰²) | âš™ï¸ |
| æ¥å£è°ƒç”¨ | `api` | `#f59e0b` (æ©™è‰²) | ğŸ”— |
| æ¥å£å¾ªç¯è°ƒç”¨ | `api-loop` | `#3b82f6` (è“è‰²) | ğŸ”„ |
| æ¡ä»¶ç½‘å…³ | `condition-gateway` | `#8b5cf6` (ç´«è‰²) | â—‡ |

#### æ¡ä»¶ç½‘å…³ XML ç»“æ„ â­ æ–°åŠŸèƒ½

```xml
<?xml version="1.0" encoding="UTF-8"?>
<workflow name="å·¥ä½œæµåç§°">
  <nodes>
    <!-- æ¡ä»¶ç½‘å…³èŠ‚ç‚¹ -->
    <node id="gateway-e0" type="condition-gateway" label="æ¡ä»¶ç½‘å…³"
          statusValue="200"
          paramName="result"
          paramOperator="eq"
          paramValue="success">
      <position x="300" y="200"/>
    </node>
    <!-- æ™®é€šèŠ‚ç‚¹ -->
    <node id="n1" type="api" label="å¼€å§‹èŠ‚ç‚¹">
      <position x="100" y="200"/>
      <interfaceName>startProcess</interfaceName>
    </node>
  </nodes>
  <edges>
    <!-- ä¸»è¾¹ï¼šæºèŠ‚ç‚¹åˆ°ç½‘å…³ -->
    <edge id="e0" source="n1" target="gateway-e0"/>
    
    <!-- å¸¦åˆ†æ”¯çš„è¾¹ï¼šç½‘å…³åˆ°ç›®æ ‡èŠ‚ç‚¹ -->
    <edge id="e1" source="gateway-e0" target="n2"
          statusValue="200"
          paramName="result"
          paramOperator="eq"
          paramValue="success">
      <!-- åˆ†æ”¯1ï¼šæˆåŠŸåˆ†æ”¯ -->
      <edge target="n3"
            paramName="code"
            paramOperator="regex"
            paramValue="^20"/>
      <!-- åˆ†æ”¯2ï¼šå¤±è´¥åˆ†æ”¯ -->
      <edge target="n4"
            statusValue="500"/>
    </edge>
  </edges>
</workflow>
```

#### åˆ†æ”¯åµŒå¥—ç¤ºä¾‹ â­ æ–°åŠŸèƒ½

```xml
<?xml version="1.0" encoding="UTF-8"?>
<workflow name="åµŒå¥—æ¡ä»¶ç¤ºä¾‹">
  <nodes>
    <node id="start" type="api" label="å¼€å§‹">
      <position x="100" y="100"/>
      <interfaceName>start</interfaceName>
    </node>
    <node id="process" type="api" label="å¤„ç†">
      <position x="400" y="100"/>
      <interfaceName>process</interfaceName>
    </node>
  </nodes>
  <edges>
    <!-- ä¸»è¾¹å¸¦åµŒå¥—åˆ†æ”¯ (æœ€å¤š3å±‚) -->
    <edge id="e0" source="start" target="process" priority="0"
          statusValue="200">
      <!-- ç¬¬1å±‚åˆ†æ”¯ -->
      <edge target="branch1" paramName="type" paramOperator="eq" paramValue="A">
        <!-- ç¬¬2å±‚åµŒå¥—åˆ†æ”¯ -->
        <edge target="branch1-1" paramName="subType" paramOperator="eq" paramValue="A1">
          <!-- ç¬¬3å±‚åµŒå¥—åˆ†æ”¯ (æœ€å¤§å±‚æ•°) -->
          <edge target="branch1-1-1" paramName="detail" paramOperator="eq" paramValue="X"/>
        </edge>
        <edge target="branch1-2" paramName="subType" paramOperator="eq" paramValue="A2"/>
      </edge>
      <!-- ç¬¬1å±‚åˆ†æ”¯2 -->
      <edge target="branch2" paramName="type" paramOperator="eq" paramValue="B"/>
    </edge>
  </edges>
</workflow>
```

#### å®Œæ•´ XML ç¤ºä¾‹

```xml
<?xml version="1.0" encoding="UTF-8"?>
<workflow name="å®¡æ‰¹æµç¨‹">
  <nodes>
    <node id="1709900000001" type="api" label="æäº¤ç”³è¯·">
      <position x="250" y="50"/>
      <interfaceName>submitApplication</interfaceName>
    </node>
    <node id="1709900000002" type="api-loop" label="å®¡æ‰¹">
      <position x="250" y="150"/>
      <interfaceName>approve</interfaceName>
      <collectionName>approvals</collectionName>
    </node>
    <node id="gateway-1" type="condition-gateway" label="å®¡æ‰¹ç»“æœ">
      <position x="250" y="280"/>
    </node>
    <node id="1709900000003" type="api" label="ç»“æŸæµç¨‹">
      <position x="250" y="420"/>
      <interfaceName>finishProcess</interfaceName>
    </node>
  </nodes>
  <edges>
    <edge id="e0" source="1709900000001" target="1709900000002"/>
    <edge id="e1" source="1709900000002" target="gateway-1" priority="0"
          statusValue="200"/>
    <!-- å¸¦åˆ†æ”¯çš„æ¡ä»¶è¾¹ -->
    <edge id="e2" source="gateway-1" target="1709900000003" priority="0"
          statusValue="200">
      <edge target="approved-node" paramName="result" paramOperator="eq" paramValue="approved"/>
      <edge target="rejected-node" paramName="result" paramOperator="eq" paramValue="rejected"/>
    </edge>
  </edges>
</workflow>
```

### æ ¸å¿ƒå®ç°é€»è¾‘

#### 1. æ‹–æ‹½èŠ‚ç‚¹å®ç°

```plantuml
@startuml
skinparam backgroundColor white

actor User
participant "Sidebar\nç»„ä»¶åº“" as SB
participant "DesignerView\nè®¾è®¡å™¨" as DV
participant "VueFlow\nç”»å¸ƒ" as VF

User -> SB : æ‹–æ‹½èŠ‚ç‚¹å¼€å§‹\n(HTML5 Drag & Drop)
SB -> DV : onDragStart(event, node)
DV -> DV : event.dataTransfer.setData\nè®¾ç½®èŠ‚ç‚¹ç±»å‹æ•°æ®
DV -> DV : effectAllowed = 'move'

User -> VF : é‡Šæ”¾åˆ°ç”»å¸ƒåŒºåŸŸ
VF -> DV : onDrop(event)
DV -> DV : è®¡ç®—èŠ‚ç‚¹ä½ç½®\n(x: clientX - rect.left)
DV -> DV : ç”ŸæˆèŠ‚ç‚¹ID\n(Date.now())
DV -> DV : è®¾ç½®showMask = true\næ˜¾ç¤ºé®ç½©å±‚
DV -> VF : addNodes([newNode])
DV -> DV : è‡ªåŠ¨èšç„¦åç§°è¾“å…¥æ¡†
VF --> User : æ˜¾ç¤ºæ–°èŠ‚ç‚¹+é®ç½©

User -> DV : è¾“å…¥èŠ‚ç‚¹åç§°
DV -> DV : æ ¡éªŒåç§°\n(1-32éç©ºç™½å­—ç¬¦)
User -> DV : ç¦»å¼€è¾“å…¥æ¡†
DV -> DV : éªŒè¯é€šè¿‡\nè®¾ç½®showMask = false
DV --> User : é®ç½©æ¶ˆå¤±ï¼Œå¯ç»§ç»­æ“ä½œ

alt éªŒè¯ä¸é€šè¿‡
  DV -> DV : åˆ é™¤èŠ‚ç‚¹
  DV --> User : èŠ‚ç‚¹æ¶ˆå¤±
end
@enduml
```

#### 2. èŠ‚ç‚¹åç§°æ ¡éªŒ

```plantuml
@startuml
skinparam backgroundColor white
skinparam ActivityBackgroundColor white

start
:åˆ›å»ºèŠ‚ç‚¹å\nshowMask = true
:è‡ªåŠ¨èšç„¦åç§°è¾“å…¥æ¡†

while (ç”¨æˆ·è¾“å…¥ä¸­?) is (æœªè¾“å…¥)
  :æ˜¾ç¤ºé®ç½©\né˜»æ­¢å…¶ä»–æ“ä½œ
endwhile (å¼€å§‹è¾“å…¥)

:hasStartedTyping = true
:æ˜¾ç¤ºæ ¡éªŒè§„åˆ™æç¤º
:åç§°ä¸º1-32ä¸ªéç©ºç™½å­—ç¬¦

if (è¾“å…¥æ¡†å¤±å»ç„¦ç‚¹?) then (æ˜¯)
  :æ£€æŸ¥åç§°æœ‰æ•ˆæ€§
  if (åç§°æœ‰æ•ˆ?) then (æ˜¯)
    :æ¸…é™¤é®ç½©
    :hasStartedTyping = false
    :å…è®¸å…¶ä»–æ“ä½œ
  else (å¦)
    :å»¶è¿Ÿ10ms
    :åˆ é™¤èŠ‚ç‚¹
    :æ¸…é™¤é®ç½©
  endif
endif

stop
@enduml
```

#### 3. è¿çº¿çŠ¶æ€ç®¡ç†

```plantuml
@startuml
skinparam backgroundColor white

participant "User" as U
participant "DesignerView" as DV
collections "handleConnections\nMap<nodeId:handleId, edgeId[]>" as HC

U -> DV : ä»æºèŠ‚ç‚¹æ‹–æ‹½åˆ°ç›®æ ‡èŠ‚ç‚¹
DV -> DV : onConnect(connection)
DV -> HC : sourceKey = "æºèŠ‚ç‚¹:æºè¿æ¥ç‚¹"
HC --> DV : è·å–å·²æœ‰edgeIdåˆ—è¡¨
DV -> HC : push(newEdgeId)
DV -> DV : addEdges([newEdge])

DV --> U : ç”»å¸ƒæ˜¾ç¤ºè¿çº¿

U -> DV : åŒå‡»é€‰ä¸­è¿çº¿
DV -> HC : sourceKey/targetKey\næŸ¥æ‰¾å…³è”edgeId
HC --> DV : è¿”å›å…³è”çš„edgeIdåˆ—è¡¨
DV -> DV : splice() ä»elementsåˆ é™¤
DV -> HC : ä»Mapä¸­ç§»é™¤edgeId
DV --> U : è¿çº¿ä»ç”»å¸ƒæ¶ˆå¤±
@enduml
```

#### 4. è¿æ¥ç‚¹æ™ºèƒ½æ˜¾ç¤º

```plantuml
@startuml
skinparam backgroundColor white

rectangle "CustomNode" as CN {
  rectangle "isTopConnected\ncomputed" as Top
  rectangle "isBottomConnected\ncomputed" as Bottom
  rectangle "Handle\n(top, target)" as HT
  rectangle "Handle\n(bottom, source)" as HB
}

rectangle "DesignerView" as DV {
  rectangle "handleConnections\nMap" as Map
}

Map --> Top : æŸ¥è¯¢æ˜¯å¦å·²è¿æ¥
Map --> Bottom : æŸ¥è¯¢æ˜¯å¦å·²è¿æ¥
Top --> HT : connected = true/false
Bottom --> HB : connected = true/false

HT --> HT : opacity: 0\né»˜è®¤éšè—
HB --> HT : opacity: 0\né»˜è®¤éšè—

note right of HT
  connected === true
  opacity: 1 æ°¸ä¹…æ˜¾ç¤º
end note
@enduml
```

#### 5. XML è§£ææµç¨‹

```plantuml
@startuml
skinparam backgroundColor white
skinparam ActivityBackgroundColor white

start
:parseXML(xmlString);
:DOMParserè§£æXML;
if (å‘ç°parsererror?) then (æ˜¯)
  :æŠ›å‡ºé”™è¯¯"XMLæ ¼å¼æ— æ•ˆ";
  stop
endif

:æŸ¥è¯¢workflowæ ¹å…ƒç´ ;
if (ç¼ºå°‘æ ¹å…ƒç´ ?) then (æ˜¯)
  :æŠ›å‡ºé”™è¯¯"ç¼ºå°‘workflowæ ¹å…ƒç´ ";
  stop
endif

:æå–workflowåç§°;

:æŸ¥è¯¢nodeså…ƒç´ ;
if (ç¼ºå°‘nodes?) then (æ˜¯)
  :æŠ›å‡ºé”™è¯¯"ç¼ºå°‘nodesèŠ‚ç‚¹";
  stop
endif

while (éå†æ‰€æœ‰nodeå…ƒç´ )
  :æå–id, type, labelå±æ€§;
  :æå–positionå…ƒç´ å’Œx,yåæ ‡;
  :æ·»åŠ åˆ°nodesæ•°ç»„;
endwhile

:æŸ¥è¯¢edgeså…ƒç´  (å¯é€‰);
if (å­˜åœ¨edges?) then (æ˜¯)
  while (éå†æ‰€æœ‰edgeå…ƒç´ )
    :æå–source, targetå±æ€§;
    :æ·»åŠ åˆ°edgesæ•°ç»„;
  endwhile
endif

:è¿”å›WorkflowDataå¯¹è±¡;
stop
@enduml
```

### ç»„ä»¶é€šä¿¡

#### HomeView â†’ DesignerView æ•°æ®ä¼ é€’

1. **HomeView** é€‰æ‹© XML æ–‡ä»¶å
2. è°ƒç”¨ `parseXML()` è§£æ XML å­—ç¬¦ä¸²
3. è°ƒç”¨ `workflowStore.setImportedWorkflow(data)` å­˜å‚¨åˆ° Pinia
4. è·¯ç”±è·³è½¬åˆ° `/designer`
5. **DesignerView** `onMounted` æ—¶æ£€æŸ¥ `workflowStore.hasImportedData`
6. è°ƒç”¨ `loadImportedWorkflow()` æ¢å¤ç”»å¸ƒçŠ¶æ€
7. è°ƒç”¨ `clearImportedWorkflow()` é˜²æ­¢åˆ·æ–°é‡å¤åŠ è½½

#### å…³é”®æ–‡ä»¶èŒè´£

| æ–‡ä»¶ | èŒè´£ |
|------|------|
| `HomeView.vue` | é¦–é¡µå…¥å£ï¼ŒXMLæ–‡ä»¶é€‰æ‹©ä¸è§£æ |
| `DesignerView.vue` | è®¾è®¡å™¨ä¸»é¡µé¢ï¼ŒèŠ‚ç‚¹æ‹–æ‹½ã€è¿çº¿ã€æ¡ä»¶ç½‘å…³ã€å¯¼å‡ºã€åç§°æ ¡éªŒ |
| `CustomNode.vue` | è‡ªå®šä¹‰èŠ‚ç‚¹ç»„ä»¶ï¼Œè¿æ¥ç‚¹æ˜¾ç¤ºé€»è¾‘ |
| `ConditionGatewayNode.vue` | â­ æ¡ä»¶ç½‘å…³èŠ‚ç‚¹ç»„ä»¶ï¼Œæ”¯æŒå¤šåˆ†æ”¯æ˜¾ç¤º |
| `workflow.ts` | PiniaçŠ¶æ€ç®¡ç†ï¼Œè·¨é¡µé¢æ•°æ®ä¼ é€’ |
| `xmlParser.ts` | XMLè§£æä¸å¯¼å‡ºï¼Œæ”¯æŒåµŒå¥—æ¡ä»¶è¾¹ |
| `router/index.ts` | è·¯ç”±é…ç½®ï¼ŒåŒé¡µé¢åº”ç”¨ |

#### æ¡ä»¶ç½‘å…³ç›¸å…³ç»„ä»¶ â­ æ–°åŠŸèƒ½

```
ConditionGatewayNode.vue
â”œâ”€â”€ Props:
â”‚   â”œâ”€â”€ id: string              # ç½‘å…³èŠ‚ç‚¹ID
â”‚   â”œâ”€â”€ label: string           # æ˜¾ç¤ºåç§°
â”‚   â”œâ”€â”€ color?: string          # èŠ‚ç‚¹é¢œè‰² (é»˜è®¤ç´«è‰²)
â”‚   â”œâ”€â”€ conditions?: {...}      # ä¸»æ¡ä»¶é…ç½®
â”‚   â””â”€â”€ branches?: Branch[]     # åˆ†æ”¯åˆ—è¡¨
â”œâ”€â”€ Template:
â”‚   â”œâ”€â”€ ç½‘å…³å›¾æ ‡ (â—‡)
â”‚   â”œâ”€â”€ å…¥è¾¹è¿æ¥ç‚¹ (left)      # æ¥æ”¶æºèŠ‚ç‚¹è¿çº¿
â”‚   â”œâ”€â”€ å‡ºè¾¹è¿æ¥ç‚¹ (right)     # è¿æ¥ç›®æ ‡èŠ‚ç‚¹
â”‚   â””â”€â”€ åˆ†æ”¯è¿æ¥ç‚¹ (top/bottom äº¤æ›¿)  # æœ€å¤š5ä¸ª
â””â”€â”€ æ ·å¼:
    â”œâ”€â”€ 20x20px åœ†å½¢è®¾è®¡
    â”œâ”€â”€ ç´«è‰²èƒŒæ™¯ (#8b5cf6)
    â”œâ”€â”€ ç™½è‰²è¾¹æ¡†
    â””â”€â”€ æ‚¬æµ®æ˜¾ç¤ºåˆ†æ”¯è¿æ¥ç‚¹
```

### æ¡ä»¶ç½‘å…³å®ç°é€»è¾‘ â­ æ–°åŠŸèƒ½

```plantuml
@startuml
skinparam backgroundColor white

actor User
participant "DesignerView\nè®¾è®¡å™¨" as DV
participant "ConditionGatewayNode\nç½‘å…³èŠ‚ç‚¹" as GN
participant "XML Parser\nXMLè§£æå™¨" as XML

User -> DV : å³é”®ç‚¹å‡»è¿çº¿
DV -> DV : æ˜¾ç¤ºå³é”®èœå•
User -> DV : é€‰æ‹©"è½¬æ¢ä¸ºæ¡ä»¶ç½‘å…³"
DV -> DV : åˆ›å»ºç½‘å…³èŠ‚ç‚¹ï¼ˆè¿çº¿ä¸­ç‚¹ï¼‰
DV -> DV : ä¿ç•™åŸè¿çº¿ä½œä¸ºå‡ºè¾¹ï¼ˆç»§æ‰¿æ¡ä»¶ï¼‰
DV -> DV : åˆ›å»ºå…¥è¾¹ï¼ˆæºèŠ‚ç‚¹â†’ç½‘å…³ï¼‰
DV -> DV : åˆ›å»ºåˆ†æ”¯ç®¡ç†çŠ¶æ€

DV -> GN : æ¸²æŸ“20pxç´«è‰²åœ†å½¢ç½‘å…³èŠ‚ç‚¹
GN --> User : æ˜¾ç¤ºè¿·ä½ ç½‘å…³å›¾æ ‡

User -> DV : ç‚¹å‡»ç½‘å…³èŠ‚ç‚¹
DV -> DV : å±•å¼€ç½‘å…³å±æ€§é¢æ¿
User -> DV : ç¼–è¾‘é»˜è®¤åˆ†æ”¯æ¡ä»¶
DV -> DV : æ›´æ–°gatewayConditions

User -> DV : ç‚¹å‡»"æ·»åŠ åˆ†æ”¯"
DV -> DV : æ·»åŠ æ–°åˆ†æ”¯åˆ°åˆ—è¡¨
DV -> DV : æ¿€æ´»åˆ†æ”¯è¿æ¥ç‚¹

User -> DV : ä»åˆ†æ”¯ç‚¹æ‹–æ‹½è¿æ¥ç›®æ ‡èŠ‚ç‚¹
DV -> DV : åˆ›å»ºåˆ†æ”¯è¿çº¿
DV -> DV : ä¿å­˜åˆ†æ”¯æ¡ä»¶
DV -> DV : ç”ŸæˆåµŒå¥—XML

User -> DV : å¯¼å‡ºXML
DV -> XML : generateXML()
XML --> DV : è¿”å›XMLå­—ç¬¦ä¸²
@enduml
```

### åµŒå¥—æ¡ä»¶è§£ææµç¨‹ â­ æ–°åŠŸèƒ½

```plantuml
@startuml
skinparam backgroundColor white
skinparam ActivityBackgroundColor white

start
:parseXML(xmlString);
:DOMParserè§£æXML;

while (éå†æ‰€æœ‰edgeå…ƒç´ )
  :æå–source, targetå±æ€§;
  :æå–conditionsæ¡ä»¶å±æ€§;
  
  :æŸ¥è¯¢åµŒå¥—çš„edgeå­å…ƒç´ ;
  if (å­˜åœ¨åµŒå¥—edge?) then (æ˜¯)
    while (éå†åµŒå¥—edge)
      :æå–targetå±æ€§;
      :æå–å­æ¡ä»¶;
      
      :åˆ›å»ºåˆ†æ”¯å¯¹è±¡;
      :æ·»åŠ åˆ°branchesæ•°ç»„;
      
      :é€’å½’æ£€æŸ¥æ›´æ·±å±‚åµŒå¥—;
    endwhile
  endif
  
  :åˆ›å»ºä¸»è¾¹å¯¹è±¡;
  :æ·»åŠ åˆ°edgesæ•°ç»„;
endwhile

:è¿”å›å¸¦åµŒå¥—æ¡ä»¶çš„WorkflowData;
stop
@enduml
```

### æ ·å¼è®¾è®¡

#### é¦–é¡µæ¸å˜èƒŒæ™¯

- æ¸å˜è‰²å½©ï¼šä»ç´«è“è‰² (#667eea) åˆ°æ·±ç´«è‰² (#764ba2)
- æ¸å˜è§’åº¦ï¼š135åº¦å¯¹è§’çº¿

#### èŠ‚ç‚¹é¢œè‰²ç³»ç»Ÿ

| ç±»å‹ | é¢œè‰²ä»£ç  | è‰²å½© |
|------|----------|------|
| å­æµç¨‹ | `#10b981` | ç»¿è‰² |
| æ¥å£è°ƒç”¨ | `#f59e0b` | æ©™è‰² |
| æ¥å£å¾ªç¯è°ƒç”¨ | `#3b82f6` | è“è‰² |
| æ¡ä»¶ç½‘å…³ | `#8b5cf6` | ç´«è‰² â­ æ–°å¢ |
| æ¡ä»¶ç½‘å…³è¾¹æ¡† | `#7c3aed` | æ·±ç´«è‰² â­ æ–°å¢ |

#### èŠ‚ç‚¹é»˜è®¤å°ºå¯¸

- æœ€å°å®½åº¦ï¼š120px
- æœ€å°é«˜åº¦ï¼š50px
- å†…è¾¹è·ï¼š10px 20px
- è®¾è®¡ç›®çš„ï¼šé¿å…è¾“å…¥åç§°åèŠ‚ç‚¹å˜å½¢

#### æ¡ä»¶ç½‘å…³èŠ‚ç‚¹æ ·å¼ â­ æ–°åŠŸèƒ½ (v2.1 æ›´æ–°)

| å±æ€§ | å€¼ | è¯´æ˜ |
|------|-----|------|
| å°ºå¯¸ | 20px Ã— 20px | åœ†å½¢è®¾è®¡ï¼Œæœ€å°åŒ–è§†è§‰å¹²æ‰° |
| èƒŒæ™¯è‰² | `#8b5cf6` (ç´«è‰²) | é†’ç›®æ ‡è¯† |
| è¾¹æ¡†è‰² | rgba(255,255,255,0.6) | ç™½è‰²åŠé€æ˜è¾¹æ¡† |
| å›¾æ ‡ | â—‡ | å±…ä¸­æ˜¾ç¤º |
| å›¾æ ‡é¢œè‰² | rgba(255,255,255,0.95) | é«˜å¯¹æ¯”åº¦ç™½è‰² |
| é˜´å½± | 0 2px 4px rgba(0,0,0,0.2) | è½»å¾®é˜´å½±å¢å¼ºå±‚æ¬¡ |
| æ‚¬æµ®æ•ˆæœ | æ”¾å¤§1.1å€ + åŠ æ·±é˜´å½± | äº¤äº’åé¦ˆ |

#### è¿çº¿æ ·å¼

- è¿æ¥çº¿ç±»å‹ï¼šç›´çº¿ (straight)
- è¿çº¿é¢œè‰²ï¼šé»‘è‰² (#000000)
- çº¿å®½ï¼š2px
- ç®­å¤´ç±»å‹ï¼šå®å¿ƒç®­å¤´ (arrow)
  - ç®­å¤´é¢œè‰²ï¼šé»‘è‰² (#000000)

---

## æ–°åŠŸèƒ½æ›´æ–°æ—¥å¿—

### v2.0 - æ¡ä»¶ç½‘å…³åŠŸèƒ½ (2024)

#### æ–°å¢åŠŸèƒ½
- **æ¡ä»¶ç½‘å…³èŠ‚ç‚¹** - æ”¯æŒæ¡ä»¶åˆ†æ”¯çš„å¯è§†åŒ–ç½‘å…³
- **åµŒå¥—æ¡ä»¶** - æœ€å¤šæ”¯æŒ 3 å±‚æ¡ä»¶åµŒå¥—
- **åˆ†æ”¯ç®¡ç†** - æ¯ä¸ªç½‘å…³æœ€å¤š 5 ä¸ªåˆ†æ”¯
- **æ¡ä»¶ç»§æ‰¿** - åˆ†æ”¯å¯ç»§æ‰¿ç½‘å…³ä¸»æ¡ä»¶
- **å³é”®èœå•** - ä¾¿æ·çš„æ¡ä»¶ç½‘å…³åˆ›å»ºæ“ä½œ

#### æ–°å¢ç»„ä»¶
- `ConditionGatewayNode.vue` - æ¡ä»¶ç½‘å…³èŠ‚ç‚¹ç»„ä»¶

#### æ›´æ–°æ–‡ä»¶
- `xmlParser.ts` - æ”¯æŒåµŒå¥—æ¡ä»¶ XML è§£æå’Œç”Ÿæˆ
- `DesignerView.vue` - æ¡ä»¶ç½‘å…³åˆ›å»ºå’Œç®¡ç†ç•Œé¢
- `CustomNode.vue` - å¢å¼ºè¿æ¥ç‚¹æ˜¾ç¤ºé€»è¾‘

#### XML æ•°æ®ç±»å‹æ‰©å±•

```typescript
// æ“ä½œç¬¦ç±»å‹
type ConditionOperator = 'eq' | 'ne' | 'contains' | 'regex'

// æ¡ä»¶é…ç½®
interface EdgeConditionConfig {
  statusValue?: string    // Status æ¡ä»¶å€¼
  paramName?: string      // å‚æ•°å
  paramOperator?: ConditionOperator  // å…³ç³»
  paramValue?: string     // å‚æ•°å€¼
}

// åˆ†æ”¯é…ç½®
interface ConditionBranch {
  id: string
  targetNodeId: string
  conditions: EdgeConditionConfig
  priority?: number
}

// ä¸»è¾¹æ•°æ®ï¼ˆæ”¯æŒåµŒå¥—æ¡ä»¶ï¼‰
interface EdgeData {
  id: string
  source: string
  target: string
  priority?: number
  conditions?: EdgeConditionConfig
  branches?: ConditionBranch[]
}

// æ¡ä»¶ç½‘å…³èŠ‚ç‚¹
interface NodeData {
  id: string
  type: string
  label: string
  position: { x: number; y: number }
  // ... å…¶ä»–å±æ€§
  isConditionGateway?: boolean
  gatewayConditions?: EdgeConditionConfig
}
```

#### ä½¿ç”¨é™åˆ¶
- æœ€å¤§åµŒå¥—å±‚æ•°ï¼š3 å±‚
- æ¯ä¸ªç½‘å…³æœ€å¤§åˆ†æ”¯æ•°ï¼š5 ä¸ª
- æ¯ä¸ªåˆ†æ”¯æœ€å°ä¿ç•™æ•°ï¼š1 ä¸ª
- ä¼˜å…ˆçº§èŒƒå›´ï¼š0-10ï¼ˆæ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜ï¼‰

#### æ“ä½œç¬¦æ˜¾ç¤ºæ˜ å°„

| æ“ä½œç¬¦ | XMLå±æ€§å€¼ | æ˜¾ç¤ºç¬¦å· |
|--------|----------|----------|
| ç­‰äº | `eq` | = |
| ä¸ç­‰äº | `ne` | â‰  |
| åŒ…å« | `contains` | âŠ† |
| æ­£åˆ™åŒ¹é… | `regex` | ~ |
